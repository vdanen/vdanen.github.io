<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Vincent Danen" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content=", Macos, " />

<meta property="og:title" content="PhoneValet, AppleScript, Growl, and remote voicemail notifications "/>
<meta property="og:url" content="https://vdanen.github.io/blog/phonevalet-applescript-growl-and-remote-voicemail-notifications.html" />
<meta property="og:description" content="I&#39;ve been using PhoneValet to handle the voicemail system here. It&#39;s an OS X app and it works really good. I&#39;ve run it on my desktop, but now that I have a spare OS X machine that I&#39;ve turned into a bit of a server, I&#39;ve put PhoneValet on there …" />
<meta property="og:site_name" content="Annvix" />
<meta property="og:article:author" content="Vincent Danen" />
<meta property="og:article:published_time" content="2007-06-18T22:01:00-06:00" />
<meta name="twitter:title" content="PhoneValet, AppleScript, Growl, and remote voicemail notifications ">
<meta name="twitter:description" content="I&#39;ve been using PhoneValet to handle the voicemail system here. It&#39;s an OS X app and it works really good. I&#39;ve run it on my desktop, but now that I have a spare OS X machine that I&#39;ve turned into a bit of a server, I&#39;ve put PhoneValet on there …">

        <title>PhoneValet, AppleScript, Growl, and remote voicemail notifications  · Annvix
</title>
        <link href="https://vdanen.github.io/recent.atom" type="application/atom+xml" rel="alternate" title="Annvix - Full Atom Feed" />



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://vdanen.github.io/"><span class=site-name>Annvix</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://vdanen.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://vdanen.github.io/about.html">About</a></li>
                                <li ><a href="https://vdanen.github.io/documentation.html">Documentation</a></li>
                                <li ><a href="https://vdanen.github.io/categories.html">Categories</a></li>
                                <li ><a href="https://vdanen.github.io/tags.html">Tags</a></li>
                                <li ><a href="https://vdanen.github.io/archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="https://vdanen.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://vdanen.github.io/blog/phonevalet-applescript-growl-and-remote-voicemail-notifications.html">
                PhoneValet, AppleScript, Growl, and remote voicemail notifications
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>I've been using PhoneValet to handle the voicemail system here.  It's an OS X app and it works really good.  I've run it on my desktop, but now that I have a spare OS X machine that I've turned into a bit of a server, I've put PhoneValet on there.  With PhoneValet Anywhere, I still get notifications on my desktop as to who is calling so that I don't have to lean over and look at the phone, which was one of the original reasons for purchasing it.  However, with PhoneValet on the server, in another room, I have no way of telling if there's a voicemail message unless I check my email which can be sporadic.</p>
<p>There's no functionality in PhoneValet to allow for it to tell a remote *Anywhere client that a voicemail arrived, but it does have support to run AppleScripts after a voicemail has been left.  So after an hour or so of fiddling around, I came up with a nice solution.  It's not the cleanest solution, but it works.  It involves using AppleScript, a shell script, and the growlnotify commandline client.  It's a little convoluted, but works quite well enough.  I did initially think to use ssh and ssh keys, but missed that growlnotify has support for listening to remote systems so opted to use that instead (although for receiving growl notifications from Linux boxes, using ssh/ssh keys would work very well).</p>
<p>If you're in the same situation and up for the challenge, read on.
On the system that you want to receive the notifcations, install Growl.  Go into System Preferences -&gt; Growl and hit the Network tab.  Check off the "Listen for incoming notifications" and set a Server password.</p>
<p>On the system that PhoneValet is running on, make sure Growl, and the growlnotify commandline program (in the Extras folder) are installed and create a shellscript.  I called this ~/bin/gnotify_voicemail with the following contents:</p>
<pre>
#!/bin/sh
msg="$*"
/usr/local/bin/growlnotify -n gnotify -I /Applications/iSync.app -H remote.host.com \
-P secret -s -m "$*"  Voicemail has arrived!
</pre>

<p>This needs to be edited to suit your system.  The remote host (-H; remote.host.com in this case) is the host to connect to and you need to supply the password you used previously (in this case "secret").</p>
<p>Now all you need to do is create the AppleScript.  PhoneValet looks for the voicemail-related AppleScripts in /Library/Application Support/Parliant/AppleScripts/VoiceMail/ so I created "Growl Voicemail.scpt" there with the following contents:</p>
<pre>
--This script calls the gnotify shellscript which in turn calls growlnotify on the remote system(s) in order to indicate that a voicemail has arrived

on process_voicemail_message(callerName, callerNumber, soundFilePath, callTime, lineName, domesticAreaCode, domesticNumber, mailboxName)

    set call_date to date callTime
    -- format the caller name
    if (callerName = "") then
        set cname to "Unknown"
    else
        set cname to callerName
    end if

    do shell script "/Users/vdanen/bin/gnotify_voicemail Voicemail from " & cname & " at " & callTime

end process_voicemail_message
</pre>

<p>Of course, change the location of the shellscript to match.</p>
<p>Finally, fire up PhoneValet, go into Preferences -&gt; AppleScripts, hit the "Voice Mail" tab and check off the "Growl Voicemail.scpt" script, save and exit.</p>
<p>You could also test the shellscript real quick by executing:</p>
<pre>
$ ~/bin/gnotify_voicemail "This is a test message"
</pre>

<p>Make sure the script is executable, of course.  When you execute that, you should see a growl popup on your system.</p>
<p>Now whenever you receive a voicemail you should get a popup on your workstation (or the computer that PhoneValet is not running on).  You might want to modify the Growl preferences for this so that the popups are sticky, so to do that go into the Growl preference pane, go into the Applications tab, scroll down and look for "gnotify" and make sure it's enabled.  Change the Display to "Brushed" or something similar and make sure Sticky is enabled.  Now even if the voice mail was left a minute ago or 10 hours ago, the growl notification will remain on your screen for you to see when you get back to it.</p>
<p>Of course, this also assumes your workstation is on 24/7 to receive the Growl notifications.  If it's not on, I'm pretty sure you won't get the notification.</p>
<p>Sorry, quick and hurried write-up (it's late and I want to go to bed), but hopefully that'll give you enough to get going.</p>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2007-06-18T22:01:00-06:00">Mon 18 June 2007</time>
            <h4>Category</h4>
            <a class="category-link" href="https://vdanen.github.io/categories.html#macos-ref">Macos</a>
<h4>Contact</h4>
<div id="sidebar-social-link">
    <a href="https://twitter.com/vdanen" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Twitter" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1da1f3"/><path fill="#fff" d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
    </a>
    <a href="https://github.com/vdanen" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/vdanen/" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://infosec.exchange/@vdanen" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Mastodon" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%"/><path d="m409 290c-5 24-43 50-85 56-86 11-137-6-137-6 3 13-4 54 70 52 31 0 58-7 58-7l2 27c-51 24-107 15-140 6-67-17-79-90-81-162v-59c0-74 49-96 49-96 50-24 180-22 222 0 0 0 49 22 49 96 0 0 1 55-7 93" fill="#3088d4"/><path d="m358 202v91h-35v-88c0-18-8-27-23-27-18 0-27 11-27 33v47h-34v-47c0-22-9-33-27-33-15 0-23 9-23 27v88h-35v-91c0-18 5-60 52-60 39 0 50 37 50 37s10-37 50-37c45 0 52 42 52 60"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://vdanen.github.io/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>