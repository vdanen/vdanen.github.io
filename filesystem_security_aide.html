<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/custom.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/fontawesome.min.css" media="screen">
        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Vincent Danen" />

        <meta name="description" content="AIDE (Advanced Intrustion Detection Environment) is a GPL replacement for the commercial Tripwire tool and does pretty much the same thing. Both tools monitor the local filesystem for changes by building an initial database to which subsequent checks are compared. Both use a variety of algorithms to ensure that files …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">


<meta property="og:title" content="Filesystem Security: AIDE "/>
<meta property="og:url" content="https://vdanen.github.io/filesystem_security_aide" />
<meta property="og:description" content="AIDE (Advanced Intrustion Detection Environment) is a GPL replacement for the commercial Tripwire tool and does pretty much the same thing. Both tools monitor the local filesystem for changes by building an initial database to which subsequent checks are compared. Both use a variety of algorithms to ensure that files …" />
<meta property="og:site_name" content="Annvix" />
<meta property="og:article:author" content="Vincent Danen" />
<meta property="og:article:published_time" content="2011-02-25T16:00:00-07:00" />
<meta name="twitter:title" content="Filesystem Security: AIDE ">
<meta name="twitter:description" content="AIDE (Advanced Intrustion Detection Environment) is a GPL replacement for the commercial Tripwire tool and does pretty much the same thing. Both tools monitor the local filesystem for changes by building an initial database to which subsequent checks are compared. Both use a variety of algorithms to ensure that files …">

        <title>Filesystem Security: AIDE  · Annvix
</title>
        <link rel="shortcut icon" href="https://vdanen.github.io/theme/images/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="https://vdanen.github.io/theme/images/apple-touch-icon-152x152.png" type="image/png" />
        <link rel="apple-touch-icon" href="https://vdanen.github.io/theme/images/apple-touch-icon.png"  type="image/png" />
        <link rel="apple-touch-icon" sizes="57x57" href="https://vdanen.github.io/theme/images/apple-touch-icon-57x57.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="72x72" href="https://vdanen.github.io/theme/images/apple-touch-icon-72x72.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="76x76" href="https://vdanen.github.io/theme/images/apple-touch-icon-76x76.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="114x114" href="https://vdanen.github.io/theme/images/apple-touch-icon-114x114.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="120x120" href="https://vdanen.github.io/theme/images/apple-touch-icon-120x120.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="144x144" href="https://vdanen.github.io/theme/images/apple-touch-icon-144x144.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="152x152" href="https://vdanen.github.io/theme/images/apple-touch-icon-152x152.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="152x152" href="https://vdanen.github.io/theme/images/apple-touch-icon-180x180.png" type="image/png" />
        <link href="https://vdanen.github.io/recent.atom" type="application/atom+xml" rel="alternate" title="Annvix - Full Atom Feed" />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5JGVD90SKJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5JGVD90SKJ');
</script>



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://vdanen.github.io/"><span class=site-name>Annvix</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://vdanen.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://vdanen.github.io/about">About</a></li>
                                <li ><a href="https://vdanen.github.io/documentation">Documentation</a></li>
                                <li ><a href="https://vdanen.github.io/categories">Categories</a></li>
                                <li ><a href="https://vdanen.github.io/tags">Tags</a></li>
                                <li ><a href="https://vdanen.github.io/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://vdanen.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="https://vdanen.github.io/filesystem_security_aide"> Filesystem Security: <span class="caps">AIDE</span>  </a></h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc" id="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Compiling_and_Installing_AIDE"><span class="tocnumber">1</span> <span class="toctext">Compiling and Installing <span class="caps">AIDE</span></span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Configuring_AIDE"><span class="tocnumber">2</span> <span class="toctext">Configuring <span class="caps">AIDE</span></span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#aide.conf"><span class="tocnumber">3</span> <span class="toctext">aide.conf</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Default_Groups"><span class="tocnumber">4</span> <span class="toctext">Default Groups</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#The_Checks"><span class="tocnumber">5</span> <span class="toctext">The Checks</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Initializing_the_Database"><span class="tocnumber">6</span> <span class="toctext">Initializing the Database</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Updating_the_Database"><span class="tocnumber">7</span> <span class="toctext">Updating the Database</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Final_Notes"><span class="tocnumber">8</span> <span class="toctext">Final Notes</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Resources"><span class="tocnumber">9</span> <span class="toctext">Resources</span></a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">

            <p><span class="caps">AIDE</span> (Advanced Intrustion Detection Environment) is a <span class="caps">GPL</span> replacement for the commercial Tripwire tool and does pretty much the same thing. Both tools monitor the local filesystem for changes by building an initial database to which subsequent checks are compared. Both use a variety of algorithms to ensure that files and directories that are changed are noticed. For a while, the <span class="caps">MD5</span> checksum has been considered not as reliable as it could be (files can be changed and have the <span class="caps">MD5</span>’s the same). But can you do that and defeat an <span class="caps">MD5</span> check, a <span class="caps">CRC32</span> check, a <span class="caps">SHA1</span> check, a rmd160 check, and more? Likely not. You might be able to beat one, but can you beat the combination?
</p>
<p><span class="caps">AIDE</span> can use a combination of different algorithms to determine if a file has been changed. Each time it is run after that initial run, it is compared against the original database and all changes are reported.
</p>
<p>Before running out and grabbing <span class="caps">AIDE</span> and installing it, be aware of two things. The first is that you should be installing and initializing your database on a pristine system, one that has not been connected to a network. If you connect to a network and possible get rooted before you run <span class="caps">AIDE</span>, you run the risk of creating your initial database with bad data. The chances of you finding out later may be much smaller if you rely on <span class="caps">AIDE</span> to alert you to changes.
</p>
<p>Secondly, you should store a copy of your initial database on a read-only medium immediately after creating it (and, again, before connecting to a network). If someone manages to obtain root access on your system, they can tamper with your database to make it look like nothing has happened, effectively covering their tracks. If you have a sneaking suspicion of something and execute <span class="caps">AIDE</span>, it will give you the all ok if you’re using a database on the compromised system; likely compromised by the attacker you’re trying to detect. If you have the original database on a <span class="caps">CD</span> or some other read-only medium, you can mount that medium on your system and run <span class="caps">AIDE</span> in check mode, using the original, read-only, initial database. The chances of finding issues are dramatically increased, and you know you can trust the read-only medium to the extent that an attacker did not physically affect it.
</p>
<p><span class="caps">AIDE</span> is currently still in pre-release format, so the documentation is a little scarce and it can have some quirks. The current version as of this writing is version 0.9.
</p>

<h2><span class="mw-headline" id="Compiling_and_Installing_AIDE">Compiling and Installing <span class="caps">AIDE</span></span></h2>
<p>Compiling <span class="caps">AIDE</span> is extremely straightforward. You will need the <span class="caps">GNU</span> versions of flex, bison, and make, and a C compiler like gcc. You may also want to build and install mhash prior to compiling <span class="caps">AIDE</span> to take advantage of a few more algorithms such as the haval checksum, gost checksum, and crc32 checksum. You can download mhash from <a class="external text" href="http://mhash.sourceforge.net/" rel="nofollow">mhash.sourceforge.net</a>; some systems come with mhash or have packages readily available (via contribs, ports, etc.).
</p>
<p>If you don’t have a binary package available for <span class="caps">AIDE</span>, download it and compile it.
</p>
<pre>
$ tar xvzf aide-0.9.tar.gz
$ cd aide-0.9
$ ./configure
$ make
# make install
</pre>
<p>You can configure some of <span class="caps">AIDE</span>’s behaviour by modifying the =configure= call with some options. For instance, you can define a number of syslog options to use (ie. defining the facility, ident, and priority). You can also indicate whether or not <span class="caps">AIDE</span> should build with zlib support (which you will want if you wish <span class="caps">AIDE</span> to compress it’s database file). Use <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">./configure —help</span> to get the different configuration options you would like. You may wish to use something like:
</p>
<pre>
$ ./configure --with-zlib --with-mhash --enable-mhash --with-config-file=/etc/aide.conf
</pre>
<p>This will enable zlib and mhash support, and will set the default configuration file to <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/etc/aide.conf</span>. By default, <span class="caps">AIDE</span> installs into <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/usr/local</span>.
</p>
<p>Once you have <span class="caps">AIDE</span> compiled and installed, it’s time to configure it.
</p>
<h2><span class="mw-headline" id="Configuring_AIDE">Configuring <span class="caps">AIDE</span></span></h2>
<p>Before running <span class="caps">AIDE</span> for the first time, you will need to configure it. You should also configure it to keep an eye on the data that is important to you. System files and devices are a no-brainer, but if you have gigabytes of data in your <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/home</span> directory, is it really necessary to perform such an intense integrity check on it? Depending on the data there, sure it might be. You may also want to really fine-tune <span class="caps">AIDE</span> to skip the bulk of the data there and simply keep an eye on the important things. Determining this before you commit to an initial database and bring the system up live would be a good thing.
</p>
<p>Depending on how you configured <span class="caps">AIDE</span>, your configuration file might be <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/etc/aide.conf</span> or something else. We’ll assume your configuration file is <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/etc/aide.conf</span> and that your database directory (where the database will be stored) is <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/usr/local/aide</span>, and that the <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">aide</span> program itself is installed in <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/usr/local/bin</span>.
</p>
<p>Before proceeding, you may want to make a copy of your <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">aide</span> binary as well and copy it to a read-only medium. Having a pristine binary along with the pristine database just makes sense.
</p>
<p>The first step is to modify your configuration file to reflect your system and your needs. Use your favourite editor to modify <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/etc/aide.conf</span>. The following is an example <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">aide.conf</span> file:
</p>
<h2><span class="mw-headline" id="aide.conf">aide.conf</span></h2>
<pre>
@@define BINDIR /usr/local/bin
@@define CONFDIR /etc
@@define DBDIR /usr/local/aide
@@define LOGDIR /var/log

# the database
database=file:@@{DBDIR}/aide.db.gz
database_out=file:@@{DBDIR}/aide.db.new.gz
gzip_dbout=yes

# reporting options
report_url=stdout
report_url=file:@@{LOGDIR}/aide.log
verbose=20
warn_dead_symlinks=yes

# rule definitions
# the default config file lists the pre-defined rule definitions; these are
on top of those
GLOG=&gt;
DEV=p+n+u+g
CONF=R+sha1
BIN=R+sha1
LOG=p+n+u+g
All=R+a+sha1+rmd160+tiger+crc32

# main configuration
/bin                   BIN
/lib                   BIN
/sbin                  BIN
/usr/bin               BIN
/usr/lib               BIN
/usr/sbin              BIN
/usr/local/bin         BIN
/usr/local/lib         BIN
/usr/local/sbin        BIN
!/usr/src
!/usr/local/src
/boot                  BIN
/boot/System.map$      BIN-m-c
/dev                   DEV
/etc                   CONF
/etc/mtab$             LOG
/var/log               GLOG
@@{CONFDIR}/aide.conf$ All
@@{BINDIR}/aide$       All
@@{DBDIR}/aide.db.gz$  All
</pre>
<p>This makes for a good start. You will want to fine-tune this according to your own needs, of course, but this covers the basics.
</p>
<p>We first define a few macros, which we can then use later in the configuration file. Then we define some database specifics, such as the location of the existing database and the database to create. We also indicate we want the database files compressed with gzip (which is only available if you build <span class="caps">AIDE</span> with zlib).
</p>
<p>Next we define some reporting options. We want the report printed to standard output and the log file <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/var/log/aide.log</span>. We want to increase the verbosity to 20, which is a good number (the default is 5). Finally, we want to be warned about symlinks that point to non-existant files.
</p>
<p>The next step is to define some rules. <span class="caps">AIDE</span> comes with a few pre-defined rules, and a rule is made up of different checks. The available checks for <span class="caps">AIDE</span> are:
</p>
<h2><span class="mw-headline" id="Default_Groups">Default Groups</span></h2>
<table border="0">
<tr>
<th style="background:#efefef;"> Group
</th>
<th style="background:#efefef;"> Check
</th></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">p</span> </td>
<td> permissions
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">i</span> </td>
<td> inode
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">n</span> </td>
<td> number of links
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">u</span> </td>
<td> user
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">g</span> </td>
<td> group
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">s</span> </td>
<td> size
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">b</span> </td>
<td> block count
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">m</span> </td>
<td> mtime
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">a</span> </td>
<td> atime
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">c</span> </td>
<td> ctime
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">S</span> </td>
<td> check for growing size
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">md5</span> </td>
<td> md5 checksum
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">sha1</span> </td>
<td> sha1 checksum
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">rmd160</span> </td>
<td> rmd160 checksum
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">tiger</span> </td>
<td> tiger checksum
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">haval</span> </td>
<td> haval checksum (only if mhash enabled)
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">gost</span> </td>
<td> gost checksum (only if mhash enabled)
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">crc32</span> </td>
<td> crc32 checksum (only if mhash enabled)
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">R</span> </td>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">p+i+n+u+g+s+m+c+md5</span>
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">L</span> </td>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">p+i+n+u+g</span>
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">E</span> </td>
<td> empty group
</td></tr>
<tr>
<td> <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">&gt;</span> </td>
<td> growing logfile (<span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">p+u+g+i+n+S</span>)
</td></tr></table>
<p>You can easily use the default groups, however you have the ability to define your own groups if you want to add a few more checks to certain things. You can also do it to make things easier for you to understand, as we have done above. The following new groups have been defined:
</p>
<pre>
GLOG=&gt;
DEV=p+n+u+g
CONF=R+sha1
BIN=R+sha1
LOG=p+n+u+g
All=R+a+sha1+rmd160+tiger+crc32
</pre>
<p>We’ve created <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;"><span class="caps">GLOG</span></span> as our growing logfile group. The <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;"><span class="caps">DEV</span></span> group is suitable for devices, checking permissions, number of links, user, and group entries. The <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;"><span class="caps">LOG</span></span> group is similar. The <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;"><span class="caps">CONF</span></span> group is defined to handle configuration files, checking everything in the <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">R</span> group and adding the sha1 checksum. The <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;"><span class="caps">BIN</span></span> group is similar, which will be used for checking things like binaries and libraries. Finally, we define <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">All</span> which applies every check; great for very sensitive information.
</p>
<h2><span class="mw-headline" id="The_Checks">The Checks</span></h2>
<p>Finally, the checks are defined. There are a few rules to remember with this list, which allows for a lot of flexibility.
</p>
<ul><li> Directories or files prefixed with <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">!</span> are ignored (ie. in the above, we completely ignore <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/usr/src</span> and <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/usr/local/src</span>)</li>
<li> Directories prefixed with <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">=</span> are added alone; none of its children are added. However, <span class="caps">AIDE</span> will first do a depth-first search</li>
<li> Directories and files are always treated as a regular expression; ie. <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">/usr/bin</span> is identical to <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">/usr/bin.*</span></li>
<li> Suffixing a directory or file with <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">$</span> restricts the check to that directory or file alone</li></ul>
<p>This may sound a little confusing, but it becomes easier to understand. Each check has three parts: The directive (<span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">!</span> or <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">=</span>), a regular expression for the directory/file to check, and the rule to apply.
</p>
<p>For instance:
</p>
<pre>
@@{CONFDIR}/aide.conf$ All
</pre>
<p>defines the <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">aide.conf</span> file (the regular expression <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">@@{<span class="caps">CONFDIR</span>}/aide.conf$</span>) and the rule to apply (<span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">All</span>). There is no directive here.
</p>
<pre>
!/usr/src
</pre>
<p>The directive <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">!</span> is used here to tell it not to match the regular expression <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">/usr/src</span> (which is, remember, really <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">/usr/src.*</span>).
</p>
<p>There are a few things to remember. If you wish to check something like a directory alone, and one sub-directory with contents, you may be tempted to use something like:
</p>
<pre>
=/foo R
/foo/bar R
</pre>
<p>However, this is the incorrect way to specify it. Here everything under <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/foo</span> will be added because your rule is <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">=/foo.* R</span>, so the second rule is redundant. Instead of just <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/foo</span> and the contents of <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/foo/bar</span>, you’re getting all of <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/foo</span>. To write this rule properly, you would use:
</p>
<pre>
=/foo$ R
/foo/bar R
</pre>
<p>When specifying a single file to check, always suffix it with <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">$</span> (ie. <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">/path/to/file$</span>). This will prevent someone from creating a file <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/path/to/file_hack</span> and avoiding detection (remember the regular expression <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">.*</span> is at the end of everything and applies to files and directories).
</p>
<p>A moderate understanding of regular expressions will really help you develop a configuration that suites your system and needs.
</p>
<h2><span class="mw-headline" id="Initializing_the_Database">Initializing the Database</span></h2>
<p>Once you have your configuration file configured the way you want (or the way you think you want), it’s time to execute <span class="caps">AIDE</span> for the first time to initialize the database. Remember, your system should still not be connected to a network to make sure the database you are creating is pristine and not tampered with. To create the database, execute:
</p>
<pre>
# aide --init
</pre>
<p>Depending on your configuration and the size of your filesystem, this can take a while. When the initialization is complete, move it immediately to a read-only media to ensure it remains pristine. At this point, <span class="caps">AIDE</span> does not encrypt the database at all, so the entire database is a plain <span class="caps">ASCII</span> file which would allow anyone to read or modify the file (should they obtain access to be able to do so).
</p>
<p>The next step is to run a check against the database, just to ensure that your configuration is written the way you want it to. This is also a great opportunity to modify and fine-tune your configuration to cover exactly what you want, and to omitt what you don’t want included in the database.
</p>
<p>To run the check, execute:
</p>
<pre>
# aide --check
</pre>
<p>This will check the current state of the filesystem with the database you initially created. If there are any changes, they will show up in the report. Examine the output carefully. This will indicate to you if there have been any changes to the system. Also be aware of changes you have made to the system. If you have installed new software or upgraded packages, you will see the results of those changes in the report. If you have added or removed users, or made any other system changes (ie. changes to configuration files, etc.) those changes will be reflected in the report.
</p>
<h2><span class="mw-headline" id="Updating_the_Database">Updating the Database</span></h2>
<p>Once you have your system live, with the initial database stored on <span class="caps">CD</span>-<span class="caps">ROM</span> or some other removable, read-only media, you may wish to update the database. In fact, you likely will have to as you track security updates and install new software, make changes to your configuration files, etc. You do not need to create a new database with <span style="font-family: courier; color: #7a4707; background-color: #e8e8e8; font-size: 13px; font-weight: bold;">—init</span> each time you wish to do this. Once you’ve made changes to your system, you may wish to do this immediately. The new database will be written to the file specified by the <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">database_out</span> keyword in your <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">aide.conf</span> file. You will want to place this new database onto read-only media immediately, and replace your old database with it.
</p>
<p>To update the database, execute:
</p>
<pre>
# aide --update
</pre>
<p>If you wish to use a different configuration file (with different rules, perhaps different output files, etc.) you can specify a non-default configuration file with the <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">—config=[file]</span> option to <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">aide</span>. You can also change the verbosity level per-run (overriding that specified in the configuration file) by using <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">—verbose=255</span> (or whatever verbosity level you wish to set). This is useful if you’re debugging your configuration file.
</p>
<p>Overall, <span class="caps">AIDE</span> is a very useful system to have in place. It offers a very reliable means to check system state, and while it isn’t an active alert system to warn you of compromise, like a Network Intrusion Detection System like snort, it will let you know passively if something has happened to warrant investigation. It may be too late to prevent the attack, but if nothing else, you’ll know that the attack has occured and will be able to do something about it.
</p>
<h2><span class="mw-headline" id="Final_Notes">Final Notes</span></h2>
<p>A few things to be aware of. It looks as though <span class="caps">AIDE</span> 0.9, unlike 0.8, requires a newer <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">vsnprintf</span> in glibc, so you will need a more recent glibc in order to build it for Linux (I’m not sure exactly what version of glibc is required, although I am running it on Mandrakelinux 9.0 which comes with glibc 2.25).
</p>
<p>Some operating systems, like Solaris 2.6 apparently, and Mac <span class="caps">OS</span> X 10.2 do not have this newer vsnprintf and <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">configure</span> will fail on the vsnprintf check. You can bypass this check by commenting out line 2524 in the <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">configure</span> file (the line reads <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">exit 1</span>). Unfortunately, there seems to be mixed results with this judging from the mailing list archive; in some cases <span class="caps">AIDE</span> will compile and dump core as soon as you run it, in others it fails to compile at all, and in others it looks like it might work. What most people seem to have done is stuck with <span class="caps">AIDE</span> 0.8 on these systems.
</p>
<p>Another problem I encountered was attempting to build <span class="caps">AIDE</span> on <span class="caps">OS</span> X, aside from the vsnprintf issues. Compiling mhash from source works just fine, but for some reason the <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">configure</span> script for <span class="caps">AIDE</span> refuses to see the library (whether it’s installed in <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/usr/local/lib</span> or in <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/sw/lib</span> (where the rest of the good stuff from fink resides)). It’s indicated that, in these cases, calling configure like:
</p>
<pre>
$ ./configure --with-extra-libs=-L/usr/local/lib \
--with-extra-includes=-I/usr/local/include
</pre>
<p>should work, but the mhash libraries still are not picked up during the test. I’m unsure if this is a quirk in the <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">configure</span> script or an issue with <span class="caps">OS</span> X’s environment.
</p>
<p>In short, there might be some issues getting <span class="caps">AIDE</span> to work for you, depending upon what operating system you are using. You may find that <span class="caps">AIDE</span> works flawlessly for you, and you may find yourself unable to even compile it. Dependant upon your results, you may wish to take a look at Tripwire instead. However, please do keep in mind that <span class="caps">AIDE</span> is still pre-release software so if you do come across any problems, feel free to bring it up with the developers on the mailing list.
</p>
<h2><span class="mw-headline" id="Resources">Resources</span></h2>
<ul>
<li> <a class="external text" href="https://aide.github.io" rel="nofollow"><span class="caps">AIDE</span> homepage</a></li>
<li> <a class="external text" href="http://mhash.sourceforge.net" rel="nofollow">mhash homepage</a></li>
<li> <a class="external text" href="https://www.comparitech.com/net-admin/network-intrusion-detection-tools/" rel="nofollow">Intrusion Detection Systems Explained: 11 Best <span class="caps">IDS</span> Tools Reviewed</a></li>
</ul>
            







        </div>
    </div>
    </article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        Copyright &copy; 2023 Vincent Danen
    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://vdanen.github.io/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>