<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://annvix.com/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://annvix.com/theme/css/custom.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://annvix.com/theme/css/fontawesome.min.css" media="screen">
        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Vincent Danen" />

        <meta name="description" content="Locking the system down is important, but a lot of security can be circumvented by an attacker having physical access to your computer. The easiest thing for an attacker to do is push the reset or power button on your computer, pop in their own floppy or CD-ROM, and …
" />
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">


<meta property="og:title" content="Password Protected Booting "/>
<meta property="og:url" content="https://annvix.com/password_protected_booting" />
<meta property="og:description" content="Locking the system down is important, but a lot of security can be circumvented by an attacker having physical access to your computer. The easiest thing for an attacker to do is push the reset or power button on your computer, pop in their own floppy or CD-ROM, and …" />
<meta property="og:site_name" content="Annvix" />
<meta property="og:article:author" content="Vincent Danen" />
<meta property="og:article:published_time" content="2008-03-25T13:00:00-06:00" />
<meta name="twitter:title" content="Password Protected Booting ">
<meta name="twitter:description" content="Locking the system down is important, but a lot of security can be circumvented by an attacker having physical access to your computer. The easiest thing for an attacker to do is push the reset or power button on your computer, pop in their own floppy or CD-ROM, and …">

        <title>Password Protected Booting  · Annvix
</title>
        <link rel="shortcut icon" href="https://annvix.com/theme/images/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="https://annvix.com/theme/images/apple-touch-icon-152x152.png" type="image/png" />
        <link rel="apple-touch-icon" href="https://annvix.com/theme/images/apple-touch-icon.png"  type="image/png" />
        <link rel="apple-touch-icon" sizes="57x57" href="https://annvix.com/theme/images/apple-touch-icon-57x57.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="72x72" href="https://annvix.com/theme/images/apple-touch-icon-72x72.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="76x76" href="https://annvix.com/theme/images/apple-touch-icon-76x76.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="114x114" href="https://annvix.com/theme/images/apple-touch-icon-114x114.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="120x120" href="https://annvix.com/theme/images/apple-touch-icon-120x120.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="144x144" href="https://annvix.com/theme/images/apple-touch-icon-144x144.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="152x152" href="https://annvix.com/theme/images/apple-touch-icon-152x152.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="152x152" href="https://annvix.com/theme/images/apple-touch-icon-180x180.png" type="image/png" />
        <link href="https://annvix.com/recent.atom" type="application/atom+xml" rel="alternate" title="Annvix - Full Atom Feed" />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5JGVD90SKJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5JGVD90SKJ');
</script>



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://annvix.com/"><span class=site-name>Annvix</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://annvix.com
                                    >Home</a>
                                </li>
                                <li ><a href="https://annvix.com/about">About</a></li>
                                <li ><a href="https://annvix.com/documentation">Documentation</a></li>
                                <li ><a href="https://annvix.com/categories">Categories</a></li>
                                <li ><a href="https://annvix.com/tags">Tags</a></li>
                                <li ><a href="https://annvix.com/archives">Archives</a></li>
                                <li><form class="navbar-search" action="https://annvix.com/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="https://annvix.com/password_protected_booting"> Password Protected&nbsp;Booting  </a></h1>
    </header>
</div>

<div class="row-fluid">
    <div class="span2 table-of-content">
        <nav>
        <h4>Contents</h4>
        <div class="toc" id="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Mac_OS_X_.2F_Apple_Hardware"><span class="tocnumber">1</span> <span class="toctext">Mac <span class="caps">OS</span> X / Apple Hardware</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Linux"><span class="tocnumber">2</span> <span class="toctext">Linux</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#LILO"><span class="tocnumber">2.1</span> <span class="toctext"><span class="caps">LILO</span></span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Grub"><span class="tocnumber">2.2</span> <span class="toctext">Grub</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Sparc_Hardware"><span class="tocnumber">3</span> <span class="toctext">Sparc Hardware</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#References"><span class="tocnumber">4</span> <span class="toctext">References</span></a></li>
</ul>
</div>
        </nav>
    </div>
    <div class="span8 article-content">

            <p>Locking the system down is important, but a lot of security can be circumvented by an attacker having physical access to your computer. The easiest thing for an attacker to do is push the reset or power button on your computer, pop in their own floppy or <span class="caps">CD</span>-<span class="caps">ROM</span>, and boot from it. Preventing this is a step one should take, especially if your server (or workstation, or even desktop) is in a publically or semi-publically accessible place. In other words, this pretty much applies to every system. Of course, it also depends on how important and/or critical your data is, and only you can decide on that.
</p>
<p>With different computers and different operating systems, there are a number of different ways to prevent booting from other devices, but still keep your system useable. For instance, you may not require a password to actually boot the machine, but require one to prevent using another boot method. For instance, on a server system, in the unlikely event of a power problem, you may wish your system to come back up without human intervention. Having a boot password will, obviously, halt the bootup process by waiting for someone to enter a password. This isn’t ideal. However, allowing someone physically in front of the computer to boot from their own floppy disk or a <span class="caps">CD</span>-<span class="caps">ROM</span> should not be permitted.
</p>

<h2><span class="mw-headline" id="Mac_OS_X_.2F_Apple_Hardware">Mac <span class="caps">OS</span> X / Apple Hardware</span></h2>
<p>In Mac <span class="caps">OS</span> X, this is extremely simple to do. What makes it even easier is the fact that there is one way of booting, via Open Firmware, and the “<span class="caps">BIOS</span>” that is Open Firmware is pretty straightforward across all machines (arguments about “old world” and “new world” machines not withstanding). While this doesn’t work with older machines, it works with relatively recent machines. More specifically, you need to be running an Open Firmware Boot <span class="caps">ROM</span> version later than 4.1.7 or 4.1.8. As well, booting into <span class="caps">OS</span> 9 (if you have both on your system) will reset things in Open Firmware forcing you to again make these changes.
</p>
<p>To determine your Boot <span class="caps">ROM</span> version, use the Apple System Profiler (Apple menu -&gt; About this Mac -&gt; More Info, or in <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/Applications/Utilities</span>). If you look in the Hardware Overview pane, you can see the Boot <span class="caps">ROM</span> info line which indicates the version number (in the case of my G4 1GHz powerbook the revision is 4.5.3f2).
</p>
<p>There are three types of security you can set in Open Firmware: none, command, and full. The first is for no security, and this is how Apple machines are shipped. The second (<i>command</i>) restricts what Open Firmware commands can be used without knowing the password and <i>full</i> is for complete security; you need the password to do anything (including booting).
</p>
<p>To enable the Open Firmware password, boot your system and press the <b>Apple+Option+O+F</b> key combination. This will bring you to a simple text prompt. Type the word <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">password</span> and enter your password twice. Then type <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">setenv security-mode &lt;mode&gt;</span> where &lt;mode&gt; is <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">none</span>, <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">command</span>, or <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">full</span>. Finally, once this is complete type <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">reset-all</span> to reboot the system and save your changes.
</p>
<p>To revert the changes, boot into Open Firmware and enter <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">setenv security-mode none</span> and reboot using the <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">reset-all</span> command.
</p>
<h2><span class="mw-headline" id="Linux">Linux</span></h2>
<p>Things get a little different with Linux due to all of the different hardware. If you’re running a <span class="caps">PPC</span> version of Linux (Mandrake, YellowDog, etc.) then you can use the above commands to set a password in Open Firmware on Mac machines. If you’re using an x86 version of Linux, you should set a <span class="caps">BIOS</span> password so that someone can not easily jump into the <span class="caps">BIOS</span> and change the boot order of your system. Most BIOSes allow you to have a <span class="caps">BIOS</span> password and a boot password; a password to protect the <span class="caps">BIOS</span> is sufficient.
</p>
<p>Things also get a little muddier depending on what boot loader you are using. For instance, if you use <span class="caps">LILO</span>, you can select one of the boot options or supply your own to load a kernel with specific arguments. This makes dealing with Linux a little more interesting, but still not very difficult to handle. With Linux, there are two main boot loaders in use: <span class="caps">LILO</span> and Grub. Each of them are very different and use different configuration files and syntax.
</p>
<h3><span class="mw-headline" id="LILO"><span class="caps">LILO</span></span></h3>
<p><span class="caps">LILO</span> (which stands for LInux LOader is perhaps the most widely-used Linux boot loader for x86 systems. You can protect <span class="caps">LILO</span> with a password as well, which will prevent others from specifying additional boot arguments. The following is an example <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/etc/lilo.conf</span> stanza:
</p>
<pre>
image=/boot/vmlinuz
     label="linux"
     root=/dev/hda3
     initrd=/boot/initrd.img
     read-only
     password="12345"
     restricted
</pre>
<p>In this case, a user can boot into “linux” (the label noted in the stanza) without requiring a password unless they wish to change the boot arguments (ie. execute “linux single”). The password specified here is “12345”, but storing the password in the clear like this is not a very good idea. With older versions of <span class="caps">LILO</span> you didn’t have much choice, and had to make sure that <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/etc/lilo.conf</span> was mode 0600 so no one other than root could read the file and thus obtain the password. With newer versions of <span class="caps">LILO</span>, you can leave the <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">password</span> keyword blank; ie:
</p>
<pre>
     password=""
</pre>
<p>When executing the boot installer, you will be interactively prompted for the password. The password is then cached in hashed form as a companion to the configuration file, by default using <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/etc/lilo.conf.crc</span>.
</p>
<p>There are three keywords that correspond to the password entry; <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">mandatory</span>, which indicates that the password is required to boot the image; <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">restricted</span>, which indicates that the password is required to boot the image if kernel options are specified on the command line; and <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">bypass</span> which indicates that no password is required to boot this image.
</p>
<p>Each image can have it’s own password (if specified directly in <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">lilo.conf</span>), or you can have a global password (put the <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">password</span> keyword and one of the three corresponding keywords in the global section). The latter is likely a better idea, but having individual passwords per boot image can also have it’s uses.
</p>
<p>To run the boot installer, execute:
</p>
<pre>
# lilo -v
</pre>
<p>which will rewrite the boot sector. If you need to specify the password to generate the cached password file, use:
</p>
<pre>
# lilo -v -p
</pre>
<h3><span class="mw-headline" id="Grub">Grub</span></h3>
<p>Grub (GRand Unified Bootloader) is another boot loader that is gaining more popularity among Linux users. It is quite different from <span class="caps">LILO</span> in how it works and how it’s configured. It’s also much more powerful than <span class="caps">LILO</span> and can make things much easier for local attackers. For instance, Grub can allow users to view the <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/etc/passwd</span> file directly from the command line interface, without even booting the system.
</p>
<p>To add a password to your Grub configuration, add the following to your Grub control file. Note that the location of this file is largely at your vendor’s discretion; Red Hat Linux uses <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/boot/grub/grub.conf</span> whereas Mandrakelinux uses <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/boot/grub/menu.lst</span>. It looks as though <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/boot/grub/menu.lst</span> is the preferred, and default, configuration file (according to the grub info pages and website).
</p>
<pre>
     password --md5 [password]
</pre>
<p>This tells Grub that the password is stored in <span class="caps">MD5</span> format; if <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">—md5</span> is omitted, Grub assumes the password is clear-text. To obtain the <span class="caps">MD5</span> of your password, run the Grub shell (ie. <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">/sbin/grub</span>) and execute:
</p>
<pre>
grub&gt; md5crypt
</pre>
<p>Enter your password and then cut and paste the Encrypted string that is printed to the screen (it will begin with “$1$”). For example:
</p>
<pre>
default=0
timeout=0
password --md5 $1$q6MJp/$RCW5VngqVruYS/94ZuUDZ1
title Red Hat Linux (2.4.18-3)
        root (hd0,0)
        kernel /boot/vmlinuz-2.4.18-3 ro root=/dev/sda1
        initrd /boot/initrd-2.4.18-3.img
</pre>
<p>Using this password does not require someone booting the machine to enter a password to boot an image (unless you specify the <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">lock</span> keyword in a stanza), but it will prevent them from using interactive commands in the Grub command line interface, which means they cannot pass options to the kernel and other generally insecure things that a non-password-protected Grub would allow people to do.
</p>
<h2><span class="mw-headline" id="Sparc_Hardware">Sparc Hardware</span></h2>
<p>You can password protect Sparc hardware as well, in a similar fashion as that used with Apple hardware. With the Apple, you’re using OpenFirmware, and with a Sparc you’re using OpenBoot, which is very similar in most respects. Because you can use multiple operating systems on Sparcs (Linux, OpenBSD, etc.), we will look specifically at setting the password in OpenBoot.
</p>
<p>To get into OpenBoot, press <b>Stop-A</b> on your Sparc keyboard (for those using a terminal program over a null-modem cable or something similar, you can get into OpenBoot by sending a <span class="caps">BREAK</span> character (in minicom, this is <b><span class="caps">CTRL</span>-A+F</b>).
</p>
<p>Now, there are different versions of OpenBoot, so we’ll concentrate on OpenBoot 2.x (as that is all I have available to me; if any of this is different for other versions of OpenBoot, please feel free to add how it differs).
</p>
<p>To change the security mode, type <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">setenv security-mode &lt;mode&gt;</span>, where &lt;mode&gt; is <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">none</span>, <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">command</span>, or <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">full</span>. These options are very similar to those used in OpenFirmware; <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">none</span> is fairly straightforward and will allow you to boot anything you like, modify options in OpenFirmware, etc. The <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">command</span> mode allows booting without a password, unless you pass options to the <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">b</span> command in OpenFirmware. It also restricts going into new command mode (a password is required). In <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">full</span> mode, a password is required for everything.
</p>
<p>To set the password, which should be done prior to making changes to the secuirity mode, use <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">password</span> in OpenBoot. You will be asked to type your password in twice.
</p>
<h2><span class="mw-headline" id="References">References</span></h2>
<ul><li> <a class="external text" href="http://docs.info.apple.com/article.html?artnum=106482" rel="nofollow">Mac <span class="caps">OS</span> X 10.1, 10.2: How to Set up Open Firmware Password Protection</a></li>
<li> <a class="external text" href="http://brun.dyndns.org/pub/linux/lilo" rel="nofollow"><span class="caps">LILO</span> homepage</a></li>
<li> <a class="external text" href="http://www.gnu.org/software/grub/" rel="nofollow"><span class="caps">GRUB</span> homepage</a></li>
<li> <a class="external text" href="http://docs.sun.com/db/doc/802-3241" rel="nofollow">OpenBoot 2.x Command Reference Manual</a></li></ul>
            







        </div>
    </div>
    </article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        Copyright &copy; 2024 Vincent Danen
    </div>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://annvix.com/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>