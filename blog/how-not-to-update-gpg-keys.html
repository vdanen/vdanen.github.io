<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Vincent Danen" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="gpg, Linux, " />

<meta property="og:title" content="How not to update GPG keys "/>
<meta property="og:url" content="https://vdanen.github.io/blog/how-not-to-update-gpg-keys.html" />
<meta property="og:description" content="This seems to be an ongoing saga so now I&#39;m going to vent about it. It is ridiculous that an organization supposedly as secure as CERT can have such poor distribution mechanisms for alerting users of their new GPG keys. It is really important that, when you update GPG keys …" />
<meta property="og:site_name" content="Annvix" />
<meta property="og:article:author" content="Vincent Danen" />
<meta property="og:article:published_time" content="2010-09-14T16:40:00-06:00" />
<meta name="twitter:title" content="How not to update GPG keys ">
<meta name="twitter:description" content="This seems to be an ongoing saga so now I&#39;m going to vent about it. It is ridiculous that an organization supposedly as secure as CERT can have such poor distribution mechanisms for alerting users of their new GPG keys. It is really important that, when you update GPG keys …">

        <title>How not to update GPG keys  · Annvix
</title>
        <link href="https://vdanen.github.io/recent.atom" type="application/atom+xml" rel="alternate" title="Annvix - Full Atom Feed" />



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://vdanen.github.io/"><span class=site-name>Annvix</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://vdanen.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://vdanen.github.io/about.html">About</a></li>
                                <li ><a href="https://vdanen.github.io/documentation.html">Documentation</a></li>
                                <li ><a href="https://vdanen.github.io/categories.html">Categories</a></li>
                                <li ><a href="https://vdanen.github.io/tags.html">Tags</a></li>
                                <li ><a href="https://vdanen.github.io/archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="https://vdanen.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://vdanen.github.io/blog/how-not-to-update-gpg-keys.html">
                How not to update GPG keys
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>This seems to be an ongoing saga so now I'm going to vent about it.  It is ridiculous that an organization supposedly as secure as <a href="http://www.cert.org/">CERT</a> can have such poor distribution mechanisms for alerting users of their new GPG keys.  It is really important that, when you update GPG keys and distribute the public key that you can <i>easily</i> establish trust of the new key.  There are a few ways this can be done: sign the new key with the old (known and/or trusted) key, sign any distribution mails with the old key (to ensure authenticity), include a revocation in the new key to import, and have a secure place where that information can be obtained.</p>
<p>CERT changes keys often -- way more often than their once-a-year policy on their web site indicates; well, this year they have anyways.  Previous years were one key a year.  However, they don't follow any of these "best practices".  And they know it, because I've told them in the past.  And yet, even now, they still can't get it right.  What's more amusing is that on their <a href="https://www.cert.org/contact_cert/encryptmail.html">Sending Sensitive Information to CERT</a> page, which is SSL encrypted, shows <i>two</i> different fingerprints.  For posterity, I took the following screenshot:</p>
<p><a href="http://linsec.ca/blog/wp-content/uploads/2010/09/cert-gpg.jpg"><img src="http://linsec.ca/blog/wp-content/uploads/2010/09/cert-gpg-300x165.jpg" alt="CERT&#039;s web page for posterity" title="CERT web page" width="300" height="165" class="aligncenter size-medium wp-image-835" /></a></p>
<p>The wrong fingerprint listed in section #2 belongs to the old key.</p>
<!--more-->
<p>The key released today is:</p>
<pre>
pub   2048R/72C33BD5 2010-09-13 [expires: 2011-09-30]
      Key fingerprint = 79DA 4C07 0AE5 EB20 D641  3F80 67B1 5F29 72C3 3BD5
uid                  CERT Coordination Center <cert@cert.org>
sig 3        72C33BD5 2010-09-13  CERT Coordination Center <cert@cert.org>
</pre>

<p>While the previous key is:</p>
<pre>
pub   2048R/9A478CA0 2010-03-03 [revoked: 2010-09-13]
      Key fingerprint = E9EA E7FB D8AF E5AE FD36  41DE 5146 432C 9A47 8CA0
rev          9A478CA0 2010-09-13  CERT Coordination Center <cert@cert.org>
uid                  CERT Coordination Center <cert@cert.org>
sig 3        9A478CA0 2010-03-03  CERT Coordination Center <cert@cert.org>
</pre>

<p>To see how things are getting sloppy, we need to go back a bit further to see what had been done in the past:</p>
<pre>
pub   2048R/B7FBBBC1 2010-01-20 [revoked: 2010-03-03]
      Key fingerprint = 66A6 DAC9 3014 21CB DCA6  A6F6 3389 F064 B7FB BBC1
rev          B7FBBBC1 2010-03-03  CERT Coordination Center <cert@cert.org>
uid                  CERT Coordination Center <cert@cert.org>
sig 3        B7FBBBC1 2010-01-20  CERT Coordination Center <cert@cert.org>
sig          AF30D800 2010-01-20  CERT Coordination Center <cert@cert.org>
</pre>

<p>Notice the difference here?  This third-latest key was signed by another CERT-owned key (AF30D800), which was the previous-to-that key used.  Trust is then established to the new key, <i>from</i> the old (known) key.  The most current and previous keys were not signed by their predecessors, which makes them harder to trust.  So in the last three keys, two are self-signed, one is properly signed to establish trust (by the previous key).  What's even more sad is that key AF30D800 was nicely signed: not only by the previous key, but also by a "master key" which also establishes more authenticity of the key:</p>
<pre>
pub   2048R/AF30D800 2009-06-15 [revoked: 2010-01-20]
      Key fingerprint = 943C 0A2E 4CB8 4C8F CA53  22F8 680D 4DC1 AF30 D800
rev          AF30D800 2010-01-20  CERT Coordination Center <cert@cert.org>
uid                  CERT Coordination Center <cert@cert.org>
sig 3        AF30D800 2009-06-15  CERT Coordination Center <cert@cert.org>
sig          18DEBE70 2009-06-15  Networked Systems Survivability Master Key <nomail@cert.org>
sig          14C33F57 2009-06-15  CERT Coordination Center <cert@cert.org>
</pre>

<p>Now this one is a good key, a trustable key.  The last two keys are not.</p>
<p>Couple that with the half-updated web page and you're left scratching your head -- or, at least, I was.  Not so much this time because, sadly, I'm no longer surprised.  But last time I actually phoned CERT to verify the new key's fingerprint because I had nothing to trust it with.  In fact, when the mail came out to notify of the new key, it was signed with the <i>new</i> key, not the old key.</p>
<p>Ummm... excuse me, but I can spoof sending a mail from cert@cert.org and generate my own key with the uid cert@cert.org and bloody well sign it with the spoofed key I just generated!  The only thing I couldn't do is update their web page but, honestly, I wonder how many people check.  And of those that do, have they done it in the past and noticed prior inconsistencies and just chalked it up to... incompetence?  Negligence?  Key distribution malpractice?</p>
<p>Again, there is nothing for me to trust that this new key is legit.</p>
<p>It's sad that an organization built around <i>security</i> has no clue about this.  What's worse, is they've been told (twice!) about a better way to distribute new keys.  I know.  I told them.  Both times.</p>
<p>So, to recap, these are things you <i>should</i> do when distributing a new GPG key:</p>
<ol>
<li> Sign the email sending out the <i>new</i> key with the <i>old</i> key.  Seriously, it establishes trust and proves you are who you say you are
<li> Fully and completely update your web site.  It's nice you have one, and it's nice that it's semi-updated, and even better that you can get to it via SSL.  But if it lists the new key in section 1 and section 2 is about verifying the fingerprint but lists the <i>old</i> key's fingerprint, how do you trust any of it?
<li> Sign the <i>new</i> key with the <i>old</i> key.  It proves that the person/organization who has the old key trusts the new one enough to sign it.  Like giving it a seal of approval or just saying "hey, this is legit"
<li> For Pete's sake, revoke the old key!  It doesn't have to necessarily be in the same message, but it should be revoked.  Heck, send out a mail signed with the old key, containing the new key, and then send out another message signed with the new key, revoking the old key.  Or have one email message sending two different GPG-signed sections so one email does it all.
</ol>

<p>None of this is difficult to do, and it makes trusting these new keys so much easier.  I've not paid attention to see if other people/organizations fail so badly here, but I don't get what makes this so hard to do.  It's not rocket science, just common sense.  I can see Joe Average maybe not thinking about it, but for an organization like CERT?  Come on.  How are we supposed to trust what you send out when you can't even get Simple Key Management 101 right?</p>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2010-09-14T16:40:00-06:00">Tue 14 September 2010</time>
            <h4>Category</h4>
            <a class="category-link" href="https://vdanen.github.io/categories.html#linux-ref">Linux</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://vdanen.github.io/tags.html#gpg-ref">gpg
                    <span class="superscript">7</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
    <a href="https://twitter.com/vdanen" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Twitter" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1da1f3"/><path fill="#fff" d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
    </a>
    <a href="https://github.com/vdanen" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="https://www.linkedin.com/in/vdanen/" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="LinkedIn" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%" fill="#0077b5"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
    </a>
    <a href="https://infosec.exchange/@vdanen" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Mastodon" role="img" viewBox="0 0 512 512" fill="#fff"><rect width="512" height="512" rx="15%"/><path d="m409 290c-5 24-43 50-85 56-86 11-137-6-137-6 3 13-4 54 70 52 31 0 58-7 58-7l2 27c-51 24-107 15-140 6-67-17-79-90-81-162v-59c0-74 49-96 49-96 50-24 180-22 222 0 0 0 49 22 49 96 0 0 1 55-7 93" fill="#3088d4"/><path d="m358 202v91h-35v-88c0-18-8-27-23-27-18 0-27 11-27 33v47h-34v-47c0-22-9-33-27-33-15 0-23 9-23 27v88h-35v-91c0-18 5-60 52-60 39 0 50 37 50 37s10-37 50-37c45 0 52 42 52 60"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://vdanen.github.io/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>