<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/custom.css" media="screen">
        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Vincent Danen" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">


<meta property="og:title" content="Using Courier-IMAP and SSL "/>
<meta property="og:url" content="https://vdanen.github.io/using_courier-imap_and_ssl.html" />
<meta property="og:description" content="Courier-IMAP comes with some bundled scripts to create self-signed certificates. Depending on what operating system you installed Courier-IMAP on, and whether you compiled it yourself or if you installed a pre-compiled RPM package, the location for these scripts may be different. The scripts in question are the mkimapdcert and mkpop3dcert …" />
<meta property="og:site_name" content="Annvix" />
<meta property="og:article:author" content="Vincent Danen" />
<meta property="og:article:published_time" content="2008-03-25T15:04:00-06:00" />
<meta name="twitter:title" content="Using Courier-IMAP and SSL ">
<meta name="twitter:description" content="Courier-IMAP comes with some bundled scripts to create self-signed certificates. Depending on what operating system you installed Courier-IMAP on, and whether you compiled it yourself or if you installed a pre-compiled RPM package, the location for these scripts may be different. The scripts in question are the mkimapdcert and mkpop3dcert …">

        <title>Using Courier-IMAP and SSL  · Annvix
</title>
        <link href="https://vdanen.github.io/recent.atom" type="application/atom+xml" rel="alternate" title="Annvix - Full Atom Feed" />



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://vdanen.github.io/"><span class=site-name>Annvix</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://vdanen.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://vdanen.github.io/about.html">About</a></li>
                                <li ><a href="https://vdanen.github.io/documentation.html">Documentation</a></li>
                                <li ><a href="https://vdanen.github.io/categories.html">Categories</a></li>
                                <li ><a href="https://vdanen.github.io/tags.html">Tags</a></li>
                                <li ><a href="https://vdanen.github.io/archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="https://vdanen.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="https://vdanen.github.io/using_courier-imap_and_ssl.html"> Using Courier-IMAP and SSL  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            <p>Courier-IMAP comes with some bundled scripts to create self-signed certificates. Depending on what operating system you installed Courier-IMAP on, and whether you compiled it yourself or if you installed a pre-compiled RPM package, the location for these scripts may be different. The scripts in question are the <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">mkimapdcert</span> and <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">mkpop3dcert</span> files, for IMAPS and POP3S respectively. You can use these scripts to create the certificate for your IMAPS (IMAP+SSL) and POP3S (POP3+SSL) services, or you can do it yourself. The scripts are merely wrappers for <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">openssl</span>. The scripts create a single file which have your private key and certificate together. If you only need a certificate for testing purposes, the scripts are fine. If you need to have your own CA or another CA sign the certificates, you can also use the scripts or create them yourself. In either case, you will have to send the resulting PEM file to your CA to sign.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Creating_the_SSL_Certificates"><span class="tocnumber">1</span> <span class="toctext">Creating the SSL Certificates</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Signing_the_SSL_Certificates"><span class="tocnumber">2</span> <span class="toctext">Signing the SSL Certificates</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Merging_the_Signed_Certificate_and_Self-Signed_Certificate"><span class="tocnumber">3</span> <span class="toctext">Merging the Signed Certificate and Self-Signed Certificate</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Ending_Notes"><span class="tocnumber">4</span> <span class="toctext">Ending Notes</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Creating_the_SSL_Certificates">Creating the SSL Certificates</span></h1>
<p>To create the certificates manually, execute:
</p>
<pre>
# openssl req -x509 -newkey rsa:1024 -keyout  imapd.pem -out imapd.pem -days 9999 -nodes
</pre>
<p>This creates your SSL certificate in the current directory as <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">imapd.pem</span>. For instance, on a Mandrakelinux system, the scripts and resulting PEM files would be located in <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/usr/share/courier/</span>. Send the resulting PEM file to your CA for signing. If you have your own CA (perhaps as described in SelfCA), you will need to resign the certificate with your CA certificate.
</p>
<h1><span class="mw-headline" id="Signing_the_SSL_Certificates">Signing the SSL Certificates</span></h1>
<p>If you need to sign the SSL certificates you just generated with your own CA, it's very easy to do. The following command is used if you have your CA setup as described in SelfCA, using the "old fashioned" commandline method of managing certificates. Sign the key using:
</p>
<pre>
$ openssl ca -ss_cert imapd.pem
</pre>
<p>This will create a new PEM file in your _certs/_ directory (ie. <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/Volumes/encrypted/ssl/certs/17.pem</span>). This file needs to be copied back to the server on which the certificate will be used, but it <b><i>must not</i></b> overwrite the original PEM file!
</p>
<h1><span class="mw-headline" id="Merging_the_Signed_Certificate_and_Self-Signed_Certificate">Merging the Signed Certificate and Self-Signed Certificate</span></h1>
<p>At this point, you need to replace the certificate in your original <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">imapd.pem</span> file with the certificate in the new PEM file (ie. <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">17.pem</span>). If you examine your current <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">imapd.pem</span> file you will see two or three sections: the "RSA PRIVATE KEY", "CERTIFICATE", and possibly a "DH PARAMETERS" section. In the original <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">imapd.pem</span> file, use your favourite text editor and remove the entire CERTIFICATE section (ie. the lines in between and including the "-----BEGIN CERTIFICATE-----" and "-----END CERTIFICATE-----"). Replace this section of text with the same section of text in your newly signed PEM file. <b><i>Only</i></b> copy the CERTIFICATE section with the BEGIN and END lines intact.
</p>
<p>Once you are done, save the file and you should have a new <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">imapd.pem</span> file that contains the original RSA PRIVATE KEY and the newly-signed CERTIFICATE. At this point, you can start the Courier-IMAP IMAPS service with the new certificate and test using your favourite IMAP mail client.
</p>
<p>The instructions are identical if you are creating a certificate for POP3S.
</p>
<h1><span class="mw-headline" id="Ending_Notes">Ending Notes</span></h1>
<p>This procedure is not limited to Courier-IMAP. Any service that uses a self-signed certificate (such as OpenLDAP, or Exim for TLS, etc.) can likely follow the same procedure (I have successfully used this for Courier-IMAP POP3S/IMAPS and Exim TLS).
</p>
            







        </div>
    </div>
    </article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://vdanen.github.io/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>