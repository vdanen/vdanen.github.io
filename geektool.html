<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/custom.css" media="screen">
        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Vincent Danen" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">


<meta property="og:title" content="GeekTool "/>
<meta property="og:url" content="https://vdanen.github.io/geektool.html" />
<meta property="og:description" content="GeekTool is a great application for OS X that allows you to display the contents of shell scripts, images, and files directly on the desktop. This page provides some scripts that I have written or adapted from others I&#39;ve found to provide useful information on the desktop with GeekTool. I …" />
<meta property="og:site_name" content="Annvix" />
<meta property="og:article:author" content="Vincent Danen" />
<meta property="og:article:published_time" content="2009-08-14T20:40:00-06:00" />
<meta name="twitter:title" content="GeekTool ">
<meta name="twitter:description" content="GeekTool is a great application for OS X that allows you to display the contents of shell scripts, images, and files directly on the desktop. This page provides some scripts that I have written or adapted from others I&#39;ve found to provide useful information on the desktop with GeekTool. I …">

        <title>GeekTool  · Annvix
</title>
        <link href="https://vdanen.github.io/recent.atom" type="application/atom+xml" rel="alternate" title="Annvix - Full Atom Feed" />



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://vdanen.github.io/"><span class=site-name>Annvix</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://vdanen.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://vdanen.github.io/about.html">About</a></li>
                                <li ><a href="https://vdanen.github.io/documentation.html">Documentation</a></li>
                                <li ><a href="https://vdanen.github.io/categories.html">Categories</a></li>
                                <li ><a href="https://vdanen.github.io/tags.html">Tags</a></li>
                                <li ><a href="https://vdanen.github.io/archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="https://vdanen.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="https://vdanen.github.io/geektool.html"> GeekTool  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            <p><a rel="nofollow" class="external text" href="http://projects.tynsoe.org/en/geektool/">GeekTool</a> is a great application for OS X that allows you to display the contents of shell scripts, images, and files directly on the desktop.  This page provides some scripts that I have written or adapted from others I've found to provide useful information on the desktop with GeekTool.
</p>
<p>I put all of my scripts into <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">~/bin/gt-scripts/</span> to keep them all organized and together.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Scripts"><span class="tocnumber">1</span> <span class="toctext">Scripts</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#IP_Information"><span class="tocnumber">1.1</span> <span class="toctext">IP Information</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Mini-Calendar"><span class="tocnumber">1.2</span> <span class="toctext">Mini-Calendar</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Uptime.2C_CPU.2FRAM_usage"><span class="tocnumber">1.3</span> <span class="toctext">Uptime, CPU/RAM usage</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Disk_Usage"><span class="tocnumber">1.4</span> <span class="toctext">Disk Usage</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Weather"><span class="tocnumber">1.5</span> <span class="toctext">Weather</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#The_Hit_List"><span class="tocnumber">1.6</span> <span class="toctext">The Hit List</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Revision_History"><span class="tocnumber">2</span> <span class="toctext">Revision History</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Scripts">Scripts</span></h1>
<p>The following are scripts that I use with GeekTool.  They were either written by me or were found elsewhere and adapted/improved or otherwise changed to suit my needs.
</p>
<h2><span class="mw-headline" id="IP_Information">IP Information</span></h2>
<p>This script displays your current local and external IP addresses.
</p>
<p><span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">gt-ipinfo</span>:
</p>
<pre>
#!/bin/sh

external=$(curl -s www.whatismyip.com/automation/n09230945.asp | awk {'print $1'})
internal0=$(ifconfig en0 | grep &quot;inet&quot; | grep -v 127.0.0.1 | grep -v inet6 | cut -d ' ' -f 2)
internal1=$(ifconfig en1 | grep &quot;inet&quot; | grep -v 127.0.0.1 | grep -v inet6 | cut -d ' ' -f 2)

echo &quot;External&#160;: ${external}&quot;

if [ &quot;${internal0}&quot;&#160;!= &quot;&quot; ]; then
    echo &quot;Ethernet&#160;: ${internal0}&quot;
fi

if [ &quot;${internal1}&quot;&#160;!= &quot;&quot; ]; then
    echo &quot;Ethernet&#160;: ${internal1}&quot;
fi
</pre>
<h2><span class="mw-headline" id="Mini-Calendar">Mini-Calendar</span></h2>
<p>This script displays the calendar for this month with the current day hashed out.
</p>
<p><span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">gt-cal</span>
</p>
<pre>
#!/bin/sh
cal | sed &quot;s/^/ /;s/$/ /;s/ $(date +%e) / $(date +%e | sed 's/./#/g') /&quot;
</pre>
<h2><span class="mw-headline" id="Uptime.2C_CPU.2FRAM_usage">Uptime, CPU/RAM usage</span></h2>
<p>This script displays current uptime as well as RAM and CPU usage on the system.
</p>
<p><span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">gt-cpustats</span>
</p>
<pre>
#!/bin/sh

# in 10.5 use the following:
#cpu=$(top -l 1| grep 'Load Avg' | awk '{print $12, $13}')
# in 10.6 use the following:
cpu=$(top -l 1|grep 'CPU usage' | awk '{print $7, $8}')
inactivemem=$(top -l 1 | awk '/PhysMem/ {print $6}')
freemem=$(top -l 1 | awk '/PhysMem/ {print $10}')

if [ &quot;$(echo ${inactivemem} | egrep '.*G$')&quot; ]; then
    inactivemem=$(echo ${inactivemem} | cut -d 'G' -f 1)
    let inactivemem=${inactivemem}*1024
else
    inactivemem=$(echo ${inactivemem} | cut -d 'M' -f 1)
fi

if [ &quot;$(echo ${freemem} | egrep '.*G$')&quot; ]; then
    freemem=$(echo ${freemem} | cut -d 'G' -f 1)
    let freemem=${freemem}*1024
else
    freemem=$(echo ${freemem} | cut -d 'M' -f 1)
fi

let freemem=${freemem}+${inactivemem}

freemem=$(echo &quot;scale=2; ${freemem} / 1024&quot; | bc)
uptime=$(uptime | awk '{print $3 &quot; &quot; $4 &quot; &quot; $5 }' | sed -e 's/.$//g')

echo &quot;Uptime&#160;: ${uptime}&quot;
echo &quot;CPU   &#160;: ${cpu}&quot;
echo &quot;RAM   &#160;: ${freemem}G&quot;
</pre>
<h2><span class="mw-headline" id="Disk_Usage">Disk Usage</span></h2>
<p>This script shows current mounted volumes and disk usage, separating local and remote volumes:
</p>
<p><span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">gt-df</span>
</p>
<pre>
#!/bin/sh

export LC_ALL=en_US.UTF-8
export LC_CTYPE=C

local=$(df -hl | egrep -v '(devfs|fdesc)')
remote=$(df -h | egrep -v '(devfs|fdesc|/dev/disk|map)')

echo &quot;Local filesystems:\n\n${local}\n&quot;
if [ &quot;$(echo ${remote} | grep Volumes)&quot;&#160;!= &quot;&quot; ]; then
    echo &quot;Remote filesystems:\n\n ${remote}\n&quot;
fi
</pre>
<h2><span class="mw-headline" id="Weather">Weather</span></h2>
<p>This script displays current weather conditions.  You will need to change the p= value in the URL to your own location code or you'll see what crappy weather we currently have in Edmonton.
</p>
<p><span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">gt-weather</span>:
</p>
<pre>
#!/bin/sh
weather=$(curl --silent &quot;http://xml.weather.yahoo.com/forecastrss?p=CAXX0126&amp;u=c&quot; | grep -E '(Current Conditions:|C&lt;BR)' | \
  sed -e 's/Current Conditions://' -e 's/&lt;br \/&gt;//' -e 's/&lt;b&gt;//' -e 's/&lt;\/b&gt;//' -e 's/&lt;BR \/&gt;//' -e 's/&lt;description&gt;//' -e 's/&lt;\/description&gt;//')
# doing it this way gets rid of a preceeding blank line
echo ${weather}
</pre>
<h2><span class="mw-headline" id="The_Hit_List">The Hit List</span></h2>
<p>I really like Potion Factory's <a rel="nofollow" class="external text" href="http://www.potionfactory.com/thehitlist/">The Hit List</a> but only found a script written in Ruby that would let me get the information I wanted.  I'm not 100% satisfied with this script so it will likely be updated in the future yet, but this two-script combo works pretty well for my needs right now.  It is a combination of Python and AppleScript.. AppleScript gets the data from The Hit List and Python calls the AppleScript and does all the formatting of the output.  This way I can have my upcoming list pretty much in my face all the time.
</p>
<p><span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">hitlist.scpt</span>
</p>
<pre>
tell application &quot;System Events&quot; to if (name of every process) contains &quot;The Hit List&quot; then

    set theList to &quot;&quot;
    set lf to (ASCII character 10)

    tell application &quot;The Hit List&quot;

        set upTasks to every task in upcoming list
        set todayTasks to every task in today list
        set allTasks to upTasks &amp; todayTasks

        repeat with aTask in allTasks

            if completed of aTask is true then
                set checkbox to &quot;/&quot;
            else if canceled of aTask is true then
                set checkbox to &quot;x&quot;
            else
                set checkbox to &quot;-&quot;
            end if

            set taskText to title of aTask
            set taskStart to start date of aTask
            set taskDue to due date of aTask

            set theList to theList &amp; checkbox &amp; &quot; |&quot; &amp; taskText &amp; &quot;|&quot; &amp; taskStart &amp; &quot;|&quot; &amp; taskDue &amp; lf

        end repeat
    end tell

    return theList

end if
</pre>
<p><span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">gt-hitlist.py</span>:
</p>
<pre>
#!/usr/bin/env python

import os, commands, re, calendar
from datetime import date

re_tag     = re.compile(r'@\S+')
re_context = re.compile(r'/\S+')

def print_item(todo):
    item = re_tag.sub(' ', todo['item'])  # not working

    if todo['start'] == '0':
        start  = 'TODAY!'
        prefix = '!!!'
    elif todo['start'] == '1':
        start  = 'Tomorrow'
        prefix = '***'
    else:
        start  = 'in&#160;%s days'&#160;% todo['start']
        prefix = '  +'

    pdue = '  '
    if todo['due'] == '0':
        due    = '   *** TASK IS DUE TODAY! ***'
        pdue   = '!!'
    elif todo['due'] == '1':
        due    = '   Due: Tomorrow'
    elif todo['due'] == '-1':
        due    = ''
    else:
        due    = '   Due: in&#160;%s days'&#160;% todo['due']

    print '%s%s&#160;%s'&#160;% (pdue, prefix, item)
    print '      Start:&#160;%s &#160;%s'&#160;% (start, due)



def trans_date(input_date):
    #Saturday, August 15, 2009 12:00:00 AM
    if input_date == 'none' or input_date == 'missing value':
        return '-1'

# need to handle overdue tasks

    (dname, month, day, year, time, extra) = input_date.split(' ')
    dname = dname.split(',')[0]
    day   = day.split(',')[0]
    (hour, min, sec) = time.split(':')
    month = list(calendar.month_name).index(month)

    today   = date.today()
    tdate   = date(int(year), int(month), int(day))
    timedue = str(abs(tdate - today)).split(' ')[0]
    if timedue == '0:00:00':
        timedue = '0'
    return(timedue)



output = commands.getoutput(&quot;osascript /Users/vdanen/bin/gt-scripts/hitlist.scpt&quot;)
lines  = output.split('\n')

contexts = []
tags     = []
todos    = {}
count    = 0

for items in lines:
    try:
        (status, item, start, due) = items.split('|')
    except:
        continue

    if due == 'missing value':
        due = 'none'

    if status.strip() == '/' or status.strip() == 'x':
        # don't add completed or cancelled items
        continue

    todos[count]           = {}
    todos[count]['item']   = item.strip()
    todos[count]['status'] = status.strip()
    todos[count]['start']  = trans_date(start.strip())
    todos[count]['due']    = trans_date(due.strip())

    p_ctxt = item.split(' ')
    for x in p_ctxt:
        # regexp for '@+' and '/+'
        if re_tag.search(x):
            x = x.split('@')[1]
            todos[count]['tags'] = []
            todos[count]['tags'].append(x)
            if not x in tags:
                tags.append(x)

        if re_context.search(x):
            x = x.split('/')[1]
            todos[count]['contexts'] = []
            todos[count]['contexts'].append(x)
            if not x in contexts:
                contexts.append(x)

    count += 1

notags = []

# slight bug here: if an item has more than one tag, it will
# go in only one list, not both
print 'Upcoming The Hit List items'
tags.sort()

# also need to sort by due/start dates
for t in tags:
    count = []

    for x in todos:
        if 'tags' in todos[x]:
            for ptag in todos[x]['tags']:
                if ptag == t:
                    count.append(x)
        else:
            if not x in notags:
                notags.append(x)

    if len(count) &gt; 0:
        print '\nTODO items tagged &quot;%s&quot;\n'&#160;% t
        for x in count:
            print_item(todos[x])

if len(notags) &gt;= 1:
    print '\nTODO items with no tags\n'
    for x in notags:
        print_item(todos[x])
</pre>
<h1><span class="mw-headline" id="Revision_History">Revision History</span></h1>
<ul><li> 09/01/2009 - fix the gt-hitlist.py script due to output errors from 10.6</li>
<li> 08/30/2009 - fix the gt-cpustats script with info for 10.6</li>
<li> 08/14/2009 - initial article</li>
</ul>
            







        </div>
    </div>
    </article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://vdanen.github.io/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>