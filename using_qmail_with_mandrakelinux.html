<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://vdanen.github.io/theme/css/custom.css" media="screen">
        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="Vincent Danen" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">


<meta property="og:title" content="Using qmail with Mandrakelinux "/>
<meta property="og:url" content="https://vdanen.github.io/using_qmail_with_mandrakelinux.html" />
<meta property="og:description" content="Due to the license of the qmail MTA (Mail Transport Agent), Mandrakelinux is unable to include binary packages of qmail in the distribution proper. The license does permit binary redistribution of qmail provided that it follows the precompiled var-qmail packages rules as set forth by the author, D. J. Bernstein …" />
<meta property="og:site_name" content="Annvix" />
<meta property="og:article:author" content="Vincent Danen" />
<meta property="og:article:published_time" content="2008-03-25T15:17:00-06:00" />
<meta name="twitter:title" content="Using qmail with Mandrakelinux ">
<meta name="twitter:description" content="Due to the license of the qmail MTA (Mail Transport Agent), Mandrakelinux is unable to include binary packages of qmail in the distribution proper. The license does permit binary redistribution of qmail provided that it follows the precompiled var-qmail packages rules as set forth by the author, D. J. Bernstein …">

        <title>Using qmail with Mandrakelinux  · Annvix
</title>
        <link href="https://vdanen.github.io/recent.atom" type="application/atom+xml" rel="alternate" title="Annvix - Full Atom Feed" />



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://vdanen.github.io/"><span class=site-name>Annvix</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://vdanen.github.io
                                    >Home</a>
                                </li>
                                <li ><a href="https://vdanen.github.io/about.html">About</a></li>
                                <li ><a href="https://vdanen.github.io/documentation.html">Documentation</a></li>
                                <li ><a href="https://vdanen.github.io/categories.html">Categories</a></li>
                                <li ><a href="https://vdanen.github.io/tags.html">Tags</a></li>
                                <li ><a href="https://vdanen.github.io/archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="https://vdanen.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article>
<div class="row-fluid">
    <header class="page-header span10 offset2">
    <h1><a href="https://vdanen.github.io/using_qmail_with_mandrakelinux.html"> Using qmail with Mandrakelinux  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            <p>Due to the <a rel="nofollow" class="external text" href="http://cr.yp.to/qmail/dist.html">license</a> of the <a rel="nofollow" class="external text" href="http://www.qmail.org/">qmail</a> MTA (Mail Transport Agent), Mandrakelinux is unable to include binary packages of qmail in the distribution proper. The license does permit binary redistribution of qmail provided that it follows the <a rel="nofollow" class="external text" href="http://cr.yp.to/qmail/var-qmail.html">precompiled var-qmail packages</a> rules as set forth by the author, D. J. Bernstein. Packages for Mandrake Linux, that follow these redistribution terms, have been available for some time. A brief discussion with Mr. Bernstein indicated that he did not want these packages included with Mandrakelinux, however he indicated having no problem with the packages themselves, or their availability via FTP.
</p>
<p>Since July 17th, 2000, I have been maintaining qmail and associated packages for Mandrakelinux, and they are available for Mandrakelinux 7.2 and higher. Please note that 7.2 packages are no longer being built or supported. The packages themselves are available via <a rel="nofollow" class="external text" href="http://www.ibiblio.org/pub/packages/rpmhelp/">rpmhelp.net</a> and by installing the <b>djbsupport</b> RPM from contribs, one can use urpmi to install qmail and associated packages very easily. <b>NOTE:</b> The qmail packages are no longer being maintained; this document is for reference only and while the packages are still available, you will likely need to recompile them and/or make modifications to make them work with recent versions of Mandrakelinux.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Installing_qmail"><span class="tocnumber">1</span> <span class="toctext">Installing qmail</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Configuring_qmail"><span class="tocnumber">2</span> <span class="toctext">Configuring qmail</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Patching_qmail"><span class="tocnumber">3</span> <span class="toctext">Patching qmail</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#References"><span class="tocnumber">4</span> <span class="toctext">References</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="Installing_qmail">Installing qmail</span></h1>
<p>The qmail installation process couldn't be simpler for Mandrakelinux users. You may install the djbsupport package from contribs or use the following command to add the qmail source to urpmi:
</p>
<pre>
# urpmi.addmedia qmail ftp://ftp.ibiblio.org/pub/packages/rpmhelp/Mandrake/djbware/9.0/RPMS \
with ../base/hdlist.cz
</pre>
<p>Obviously, replace the versioned sub-directory with the version of Mandrakelinux you are using; in this instance, the command would be executed on a Mandrakelinux 9.0 system.
</p>
<p>Now that urpmi is setup, decide what components of qmail you wish to install. There are three basic components: qmail itself (the SMTP server), qmail-pop3d (the POP3 server), and qmail-qmqpd (the QMQP and QMTP servers). If all you want is the SMTP server, whether this is because you plan on using another POP3 server such as Courier-IMAP, or you don't plan on using POP3 at all, you can simply execute:
</p>
<pre>
# urpmi qmail
</pre>
<p>This will install the qmail, daemontools, dot-forward, fastforward, and ucspi-tcp packages; all of which are required by qmail. If this is done with another MTA installed on the system (such as postfix), urpmi will first ask you if you wish to remove the existing MTA prior to installing qmail. Select "yes", as you should not have more than one MTA on a system at any given time.
</p>
<p>If you wish to install the POP3 package, you can use:
</p>
<pre>
# urpmi qmail-pop3d
</pre>
<p>This will install the qmail-pop3d package. The same command can be used to install qmail-qmqpd (substitute the package names accordingly). If you are installing qmail for the first time and want the POP3 server, you can simply use this last command to install the POP3 server and all the other dependencies, to install the entire package.
</p>
<p>The installer attempts to configure qmail during installation so it will work on the local system, in the same manner as one would use postfix installed out of the box. It will accept mail to and from the localhost, allowing it to be used with email clients such as pine and mutt. It will work with procmail so you can filter incoming email, and likewise works with fetchmail. Both pine and mutt have support for the Maildir format, so with a little re-configuration you can have both clients working immediately. Most other mail clients also support Maildir.
</p>
<h1><span class="mw-headline" id="Configuring_qmail">Configuring qmail</span></h1>
<p>At this point, qmail is almost ready to run. Before starting qmail, you should execute the following two commands:
</p>
<pre>
# service qmail cdb
# /etc/cron.hourly/qmail
</pre>
<p>This will initialize the <a href="/Using_tcpserver" title="Using tcpserver">tcpserver</a> cdb database. <span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">tcpserver</span> is a program similar to xinetd with facilities similar to tcp_wrappers. tcpserver is the program that listens to a specified port and follows rules indicated in cdb database files in the <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/etc/tcprules.d/</span> directory. By default, qmail is configured as a non-relaying server so in many cases, the defaults should be fine. In the <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/etc/tcprules.d/</span> directory are a few files: <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">qmail-smtp</span>, <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">qmail-pop3</span>, and <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">qmail-qmqp</span>, depending on which packages are installed. These are the flat-text files that may be modified to change your tcp rules. The corresponding <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">.cdb</span> files are the files that tcpserver actually reads. Any change made to the text files must be compiled prior to being made available to tcpserver. To compile these rules, use the qmail initscript as shown above ("<span style="font-family: courier; color: #2a2c7e; font-size: 13px; font-weight: bold;">service qmail cdb</span>").
</p>
<p>The second command builds the user database in <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/var/qmail/users/</span>. The <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">assign</span> file in this directory is used to map mail aliases to usernames.
</p>
<p>Finally, qmail can be started just like any other service:
</p>
<pre>
# service qmail start
</pre>
<p>This will start any qmail services installed; if only the qmail package is installed, only the SMTP server is started. If the POP3 and QMQP/QMTP servers are installed, they will be started as well. At this point, qmail will receive and send email to and from the local computer. To configure qmail to receive mail for specific domains or to become something more than a personal MTA, you can refer to the manpages installed in <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/var/qmail/man</span> or visit the excellent <a rel="nofollow" class="external text" href="http://web.infoave.net/~dsill/lwq.html">Life with qmail</a> website which will give you all the information you could want on configuring qmail. The configuration information and style used on LWQ was used to create these packages, so finding information and configuring qmail to your needs should be extremely straightforward.
</p>
<h1><span class="mw-headline" id="Patching_qmail">Patching qmail</span></h1>
<p>According to the author's distribution agreement, qmail must be installed a certain way, in a certain location, and contain no extra patches or changes to the pristine source. However, a good number of patches exist for qmail to extend the functionality of the software. Due to the license, these cannot be applied to the binary distribution, but there is nothing prohibiting the distribution of these patches in the source packages.
</p>
<p>To this end, patches have been included in the qmail source RPM (SRPM) which can be applied very easily. Instead of downloading the tarball and applying patches by hand, one can easily apply the patches and provide a custom RPM package, with the patches applied. This is, of course, only valid for personal use or within an organization; the patched binary RPM packages should never be distributed.
</p>
<p>The following is a list of patches that are included in the packages:
</p>
<ul><li> <b>qmailqueue</b>: A patch that can be used to add other programs to the qmail-smtpd-&gt;qmail-queue pipeline for filtering, virus scanning, etc.</li>
<li> <b>tls</b>: A patch to add TLS and SSL support to qmail</li>
<li> <b>linksync</b>: A patch to sync metadata for ReiserFS-based queues</li>
<li> <b>smtpauth</b>: A patch to provide SMTP AUTH to qmail (use <b>nocrammd5</b> to disable CRAM-MD5 support in SMTP AUTH)</li>
<li> <b>ldap</b>: A patch to provide LDAP support to qmail</li></ul>
<p>The keywords in bold above are the rebuild switches to use when building the qmail package with a particular patch. For instance, if you wanted to build a qmail package with LDAP support, you would use:
</p>
<pre>
# rpm --rebuild --with ldap qmail-1.03-20rph.src.rpm
</pre>
<p>The resulting binary RPM packages will look no different, in terms of version numbering, etc. as the packages provided on rpmhelp.net. It will have the LDAP patch applied, however. Multiple patches can be "stacked" in this manner. The only patches that can currently not be used together are the LDAP and SMTP-AUTH patches. So, for instance, if you wanted to build a qmail packages with SMTP-AUTH support, but without CRAM-MD5, and also use the qmailqueue patch, you would use:
</p>
<pre>
# rpm --rebuild --with smtpauth --with nocrammd5 --with qmailqueue \
qmail-1.03-20rph.src.rpm
</pre>
<p>The installed RPM packages will contain two special files in the <span style="font-family: courier; color: #891214; font-style: italic; font-size: 13px; font-weight: bold;">/usr/share/doc/qmail-1.03/</span> directory: README.RPM and README.patches. The README.RPM file contains build options and environment information for that particular package build. The README.patches file contains information on the available patches, including links to the author's pages for more information, and some information on the patches themselves. While care was taken to ensure the patches apply and build properly, not all of them have been tested to ensure they work properly. As the patches system has been in place for a while, and users have been using them, one can assume that they are most likely fine, but I cannot guarantee it. Building qmail with patches is completely unsupported, by both the author and myself.
</p>
<p>As you can see, qmail is a very easy SMTP server to install. The configuration is also extremely straightforward, as perusing LWQ should indicate. The security provided by qmail is exceptional, but this comes at some cost of extraneous features. The fact that qmail doesn't provide SMTP-AUTH without patching is a turn-off for many people. However, if you are looking for a powerful and secure MTA, and don't require these features, qmail is hard to beat.
</p>
<h1><span class="mw-headline" id="References">References</span></h1>
<ul><li> <a rel="nofollow" class="external text" href="http://cr.yp.to/qmail.html">Dan's qmail homepage</a></li>
<li> <a rel="nofollow" class="external text" href="http://www.qmail.org/">The qmail homepage</a></li>
<li> <a rel="nofollow" class="external text" href="http://web.infoave.net/~dsill/lwq.html">Life with qmail</a></li></ul>
            







        </div>
    </div>
    </article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://vdanen.github.io/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>